<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Processos - Ouve Matão</title>
    <link rel="stylesheet" href="css/processos.css">
    <style>
        .detalhes-extra { display: none; border: 1px solid #008080; margin: 10px 0; padding: 10px; background: #f9f9f9; }
        .respondido { color: #2e8b57; font-weight: bold; }
        .aguardando { color: #d9534f; font-weight: bold; }
        .triste { font-size: 40px; }
        .demanda-feita { margin: 10px 0; font-style: italic; color: #555; }
        </style>
    </head>
    <body>
        <div id="processos-container"></div>
        <script>
        // Busca os processos/demandas salvos no localStorage
        function getDemandas() {
            const data = localStorage.getItem('processos');
            if (!data) return [];
            try {
            return JSON.parse(data);
            } catch {
            return [];
            }
        }

        function renderProcessos() {
            const container = document.getElementById('processos-container');
            container.innerHTML = '';
            const demandas = getDemandas();
            if (demandas.length === 0) {
            container.innerHTML = '<p>Nenhuma demanda encontrada.</p>';
            return;
            }
            demandas.forEach(demanda => {
            container.innerHTML += `
                <div class="processo">
                ${demanda.categoria ? `<div class="categoria">Categoria: ${demanda.categoria}</div>` : ''}
                <div class="detalhes">Prioridade na tramitação: ${demanda.prioridade || ''}</div>
                ${demanda.setor ? `<div class="detalhes">Setor/Departamento: ${demanda.setor}</div>` : ''}
                <div class="demanda-feita">Demanda feita: ${demanda.demandaFeita || ''}</div>
                <div class="status">STATUS: <span class="${demanda.status === 'RESPONDIDO' ? 'respondido' : 'aguardando'}">${demanda.status}</span>
                    <button class="mais-detalhes">mais detalhes &#9660;</button>
                </div>
                <div class="detalhes-extra">
                    ${demanda.detalhesExtra || ''}
                </div>
                </div>
            `;
            });
        }

        renderProcessos();

        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('mais-detalhes')) {
            const extra = e.target.closest('.processo').querySelector('.detalhes-extra');
            if (extra.style.display === 'block') {
                extra.style.display = 'none';
                e.target.innerHTML = 'mais detalhes &#9660;';
            } else {
                extra.style.display = 'block';
                e.target.innerHTML = 'menos detalhes &#9650;';
            }
            }
        });
        </script>
    </body>
    </html>
